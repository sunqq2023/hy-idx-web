# 团队 IDX 释放机制说明

## 📊 释放参数

| 参数         | 值      | 说明                    |
| ------------ | ------- | ----------------------- |
| 锁仓期       | 90 天   | 锁仓期内 0% 可提取      |
| 释放期       | 90 天   | 逐步释放，每天释放一次  |
| 释放间隔     | 24 小时 | 每天更新一次可提取数量  |
| 释放次数     | 90 次   | 总共释放 90 次          |
| 每次释放比例 | 1.11%   | 每次释放总量的 1/90     |
| 总时长       | 180 天  | 锁仓 90 天 + 释放 90 天 |

---

## ⏰ 更新时间规则

### 问题：昨天提取后，今天什么时候更新释放的数据？

**答案：每天同一时间自动更新**

### 详细说明

1. **更新是自动的**
   - 不需要任何人手动触发
   - 基于区块链时间戳自动计算
   - 时间到了就可以提取

2. **更新时间点**
   - 以锁仓开始时间为基准
   - 每隔 24 小时更新一次
   - 例如：锁仓开始时间是 2024-01-01 14:30
     - 第 91 天 14:30 可提取 1.11%
     - 第 92 天 14:30 可提取 2.22%
     - 第 93 天 14:30 可提取 3.33%
     - ...以此类推

3. **提取时间灵活**
   - 不需要在更新时间点立即提取
   - 可以累积多天后一次性提取
   - 例如：第 95 天提取，可以一次性提取 5.55%

---

## 📅 时间线示例

```
第 0 天                第 90 天              第 91 天              第 180 天
  ↓                      ↓                    ↓                     ↓
开始锁仓              锁仓结束            释放 1.11%            释放 100%
0% 可提取            0% 可提取           1.11% 可提取         100% 可提取
  │                      │                    │                     │
  └──────────────────────┴────────────────────┴─────────────────────┘
       锁仓期 90 天              释放期 90 天
```

---

## 💡 实际案例

### 案例 1：按时提取

**场景**：用户每天都提取

- **锁仓开始**: 2024-01-01 10:00
- **锁仓结束**: 2024-04-01 10:00
- **第 91 天** (2024-04-02 10:00): 可提取 1.11%
- **第 92 天** (2024-04-03 10:00): 可提取 1.11%（累计 2.22%）
- **第 93 天** (2024-04-04 10:00): 可提取 1.11%（累计 3.33%）

### 案例 2：累积提取

**场景**：用户 5 天后才提取

- **锁仓开始**: 2024-01-01 10:00
- **锁仓结束**: 2024-04-01 10:00
- **第 95 天** (2024-04-06 10:00): 可一次性提取 5.55%

### 案例 3：昨天提取了，今天什么时候更新？

**场景**：用户昨天 14:30 提取了

- **昨天**: 2024-04-02 14:30 提取了 1.11%
- **今天**: 2024-04-03 14:30 可以再提取 1.11%
- **明天**: 2024-04-04 14:30 可以再提取 1.11%

**关键点**：

- 更新时间是固定的，基于锁仓开始时间
- 如果锁仓开始时间是 14:30，那么每天 14:30 都会更新
- 不是基于上次提取时间，而是基于锁仓开始时间

---

## 🔍 如何查看当前可提取数量？

### 方法 1：前端自动显示

前端会实时计算并显示：

- ✅ 总锁仓数量
- ✅ 已提取数量
- ✅ 当前可提取数量（实时计算）
- ✅ 剩余未释放数量

### 方法 2：合约查询

```bash
# 查询用户的释放信息
cast call <PRODUCTION_LOGIC_ADDRESS> \
  "userReleaseInfos(address,uint256)((uint256,uint256,uint256))" \
  <USER_ADDRESS> \
  <RELEASE_ID> \
  --rpc-url https://bsc-dataseed.binance.org/

# 返回值:
# - totalAmount: 总锁仓数量
# - startTime: 开始时间
# - releasedAmount: 已提取数量
```

### 方法 3：手动计算

```javascript
// 计算当前可提取数量
const timeElapsed = currentTime - startTime;
const lockDuration = 90 * 24 * 3600; // 90 天
const releaseDuration = 90 * 24 * 3600; // 90 天

if (timeElapsed < lockDuration) {
  // 锁仓期内
  可提取数量 = 0;
} else if (timeElapsed >= lockDuration + releaseDuration) {
  // 释放期结束
  可提取数量 = 总数量 - 已提取数量;
} else {
  // 释放期内
  const releaseElapsed = timeElapsed - lockDuration;
  const releaseDays = Math.floor(releaseElapsed / (24 * 3600));
  const 已释放比例 = releaseDays / 90;
  const 总可提取 = 总数量 * 已释放比例;
  可提取数量 = 总可提取 - 已提取数量;
}
```

---

## ⚠️ 注意事项

1. **时间精确到秒**
   - 释放时间精确到秒级
   - 例如：锁仓开始时间是 14:30:25，那么每天 14:30:25 更新

2. **不需要等待交易确认**
   - 可提取数量是自动计算的
   - 不需要任何人触发更新
   - 随时可以调用 `claimReleasedIdx()` 提取

3. **可以累积提取**
   - 不需要每天都提取
   - 可以累积多天后一次性提取
   - 不会损失任何收益

4. **Gas 费考虑**
   - 每次提取需要支付 Gas 费
   - 建议累积一定数量后再提取
   - 避免频繁提取浪费 Gas 费

---

## 📞 常见问题

### Q1: 为什么我今天提取不了？

**A**: 检查以下几点：

1. 是否还在锁仓期内？（前 90 天）
2. 是否已经提取过今天的份额？
3. 距离上次更新时间是否满 24 小时？

### Q2: 我可以一次性提取所有吗？

**A**:

- 在释放期内：只能提取已释放的部分
- 释放期结束后（第 180 天）：可以一次性提取所有剩余

### Q3: 如果我忘记提取会怎样？

**A**:

- 不会有任何损失
- 可提取数量会继续累积
- 随时可以提取累积的数量

### Q4: 更新时间是 UTC 时间还是本地时间？

**A**:

- 基于区块链时间戳（UTC 时间）
- 与时区无关
- 以锁仓开始的区块时间为准

---

## 🎯 总结

**核心要点**：

1. ⏰ 每 24 小时自动更新一次可提取数量
2. 📅 更新时间基于锁仓开始时间，不是上次提取时间
3. 💰 每次更新增加总量的 1.11%
4. 🔄 可以累积多天后一次性提取
5. ⚡ 不需要任何操作，时间到了就可以提取

**简单回答**：

> 如果昨天 14:30 提取了，今天 14:30 就会更新，可以再提取 1.11%。
